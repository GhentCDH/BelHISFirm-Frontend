@prefix :       <http://belhisfirm.be/resource/> .
@prefix bhf:    <http://belhisfirm.be/ontology#> .
@prefix owl:    <http://www.w3.org/2002/07/owl#> .
@prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd:    <http://www.w3.org/2001/XMLSchema#> .
@prefix foaf:   <http://xmlns.com/foaf/0.1/> .
@prefix org:    <http://www.w3.org/ns/org#> .
@prefix rov:    <http://www.w3.org/ns/regorg#> .
@prefix schema: <http://schema.org/> .
@prefix dct:    <http://purl.org/dc/terms/> .
@prefix vcard:  <http://www.w3.org/2006/vcard/ns#> .
@prefix rr:     <http://www.w3.org/ns/r2rml#> .

#################
# CORPORATION
##################
:CORPORATION-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """SELECT id FROM scoball.corporation""" ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/corporation/{id}" ;
                      rr:class    bhf:Corporation ] .

:CORPORATION-NAME
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """SELECT corporation, RAWTOHEX(STANDARD_HASH(corporation || name || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id
                                            FROM scoball.corporation_name WHERE name IS NOT NULL""" ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/corporation/{corporation}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasName ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/corporationName/{id}" ] ] .

:CORPORATION-LEGAL-FORM
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """SELECT corporation, RAWTOHEX(STANDARD_HASH(corporation || juridisch_statuut || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id
                                            FROM scoball.corporation_juridisch_statuut WHERE juridisch_statuut IS NOT NULL""" ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/corporation/{corporation}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasLegalForm ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/legalForm/{id}" ] ] .

:CORPORATION-LOCATION
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """SELECT corporation, RAWTOHEX(STANDARD_HASH(corporation || city || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id
                                                FROM scoball.corporation_location""" ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/corporation/{corporation}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasAddress ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/address/{id}" ] ] .

:CORPORATION-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                                            SELECT id,
                                            CASE
                                                WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                                                ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                                            END AS startdate,
                                            CASE
                                                WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                                                ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                                            END AS enddate
                                            FROM scoball.corporation
                                       """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/corporation/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:dateOfIncorporation ;
                            rr:objectMap [ rr:column   "startdate" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:dateOfDissolution ;
                            rr:objectMap [ rr:column   "enddate" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:scobID ;
                            rr:objectMap [ rr:column   "id" ;
                                           rr:datatype xsd:integer ] ] .


###################
# COROPORATION NAME
###################

:CORPORATION-NAME-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery
                              """SELECT RAWTOHEX(STANDARD_HASH(corporation || name || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id FROM scoball.corporation_name WHERE name IS NOT NULL""" ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/corporationName/{id}" ;
                      rr:class    bhf:DatedName ] .

:CORPORATION-NAME-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                                        SELECT
                                            corporation,
                                            RAWTOHEX(STANDARD_HASH(corporation || name || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id,
                                            name,
                                            startdate,
                                            CASE
                                                WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                                                ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                                            END AS startdate_fixed,
                                            CASE
                                                WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                                                ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                                            END AS enddate_fixed,
                                            source,
                                            comments
                                        FROM scoball.corporation_name
                                        WHERE name IS NOT NULL
                                        """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/corporationName/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate rdfs:label ;
                            rr:objectMap [ rr:column   "name" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:source ;
                            rr:objectMap [ rr:column   "source" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:comments ;
                            rr:objectMap [ rr:column   "comments" ;
                                           rr:datatype xsd:string ] ] .


##################
# LEGAL FORM
#################

:LEGAL-FORM-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """SELECT corporation, RAWTOHEX(STANDARD_HASH(corporation || juridisch_statuut || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id
                                    FROM scoball.corporation_juridisch_statuut WHERE juridisch_statuut IS NOT NULL""" ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/legalForm/{id}" ;
                      rr:class    bhf:LegalForm ] .

:LEGAL-FORM-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
            SELECT
                cjs.corporation AS corporation,
                cjs.juridisch_statuut AS juridisch_statuut_id,
                js.juridisch_statuut  AS juridisch_statuut_label,
                RAWTOHEX(STANDARD_HASH(cjs.corporation || cjs.juridisch_statuut || TO_CHAR(cjs.startdate,'YYYY-MM-DD'), 'SHA1')) AS id,
                CASE
                    WHEN cjs.startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                    ELSE TO_CHAR(cjs.startdate, 'YYYY-MM-DD')
                END AS startdate_fixed,
                CASE
                    WHEN cjs.enddate >= TO_DATE('3900-01-01', 'YYYY-MM-DD') THEN NULL
                    ELSE TO_CHAR(cjs.enddate, 'YYYY-MM-DD')
                END AS enddate_fixed,
                cjs.source,
                cjs.comments
            FROM scoball.corporation_juridisch_statuut cjs
            JOIN scoball.juridisch_statuut js
                ON cjs.juridisch_statuut = js.id
            WHERE cjs.juridisch_statuut IS NOT NULL
        """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/legalForm/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate rdfs:label ;
                            rr:objectMap [ rr:column   "juridisch_statuut_label" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:source ;
                            rr:objectMap [ rr:column   "source" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:comments ;
                            rr:objectMap [ rr:column   "comments" ;
                                           rr:datatype xsd:string ] ] .


###################
# LOCATION
##################
:LOCATION-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """SELECT corporation, RAWTOHEX(STANDARD_HASH(corporation || city || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id
                                        FROM scoball.corporation_location""" ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/address/{id}" ;
                      rr:class    bhf:Address ] .

:LOCATION-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                                SELECT
                                    corporation,
                                    RAWTOHEX(STANDARD_HASH(corporation || city || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) AS id,
                                    address,
                                    city,
                                    CASE
                                        WHEN LOWER(city) = 'onbekend' THEN NULL
                                        ELSE city
                                    END AS city_fixed,
                                    CASE
                                        WHEN LOWER(country) = 'onbekend' THEN NULL
                                        ELSE country
                                    END AS country,
                                    CASE
                                        WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                                        ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                                    END AS startdate_fixed,
                                    CASE
                                        WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                                        ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                                    END AS enddate_fixed
                                FROM scoball.corporation_location;
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/address/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:streetAddress ;
                            rr:objectMap [ rr:column   "address" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:city ;
                            rr:objectMap [ rr:column   "city_fixed" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:country ;
                            rr:objectMap [ rr:column   "country" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] .


###################
# STOCK
##################
:STOCK-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT id FROM scoball.stock
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/stock/{id}" ;
                      rr:class    bhf:Stock ] .

:STOCK-STOCKEXCHANGE
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT id, stockexchange FROM scoball.stock
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stock/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasStockExchange ;
                            rr:objectMap [ rr:template
                                                   "http://belhisfirm.be/resource/stockexchange/{stockexchange}" ] ] .

:STOCK-NAME
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT stock,  RAWTOHEX(STANDARD_HASH(stock || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.stock_name
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stock/{stock}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasName ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/stockname/{id}" ] ] .

:STOCK-SHARETYPE
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT s.id AS stock_id,
                           st.name AS sharetype_name
                    FROM scoball.stock s
                    JOIN scoball.sharetype st
                           ON s.sharetype = st.id
        """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stock/{stock_id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasSharetype ;
                            rr:objectMap [ rr:column   "sharetype_name" ;
                                           rr:datatype xsd:string ] ] .

:STOCK-NOTATION
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT id, stock FROM scoball.notation
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stock/{stock}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasNotation ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/notation/{id}" ] ] .

:STOCK-STOCKTYPE
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT stock, RAWTOHEX(STANDARD_HASH(stock || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.stock_type
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stock/{stock}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasStockType ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/stocktype/{id}" ] ] .

:STOCK-STOCKQUANTITY
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT stock, RAWTOHEX(STANDARD_HASH(stock || type || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.stock_quantity
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stock/{stock}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasStockQuantity ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/stockquantity/{id}" ] ] .


###################
# STOCK-EXCHANGE
##################
:STOCKEXCHANGE-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT id FROM scoball.stockexchange
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/stockexchange/{id}" ;
                      rr:class    bhf:StockExchange ] .

:STOCKEXCHANGE-NAME
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT stockexchange,
                           RAWTOHEX(STANDARD_HASH(stockexchange || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.stockexchange_name
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stockexchange/{stockexchange}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasName ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/stockexchange_name/{id}" ] ] .

:STOCKEXCHANGE-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT
                    id,
                    startdate,
                    CASE
                        WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                        ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                    END AS startdate_fixed,
                    CASE
                        WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                        ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                    END AS enddate_fixed
                FROM scoball.stockexchange
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stockexchange/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] .

:STOCKEXCHANGE-NAME-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT RAWTOHEX(STANDARD_HASH(stockexchange || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.stockexchange_name
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/stockexchange_name/{id}" ;
                      rr:class    bhf:DatedName ] .

:STOCKEXCHANGE-NAME-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT RAWTOHEX(STANDARD_HASH(stockexchange || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id,
                           CASE
                               WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                           END AS startdate_fixed,
                           CASE
                               WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                           END AS enddate_fixed,
                           name
                    FROM scoball.stockexchange_name
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/stockexchange_name/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate rdfs:label ;
                            rr:objectMap [ rr:column   "name" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] .


###################
# NOTATION
##################
:NOTATION-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT id FROM scoball.notation
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/notation/{id}" ;
                      rr:class    bhf:Notation ] .

:NOTATION-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT id, sector,
                           CASE
                               WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                           END AS startdate_fixed,
                           CASE
                               WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                           END AS enddate_fixed
                    FROM scoball.notation
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/notation/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasSector ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/sector/{sector}" ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] .

:NOTATION-NOTATION-PRICE
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT notation,
                           RAWTOHEX(STANDARD_HASH(notation || TO_CHAR(day,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.notation_price
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/notation/{notation}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasNotationPrice ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/notation_price/{id}" ] ] .


###################
# SECTOR
##################
:NOTATION-PRICE-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT RAWTOHEX(STANDARD_HASH(notation || TO_CHAR(day,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.notation_price
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/notation_price/{id}" ;
                      rr:class    bhf:NotationPrice ] .

:NOTATION-PRICE-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT day,
                           argent,
                           papier,
                           "OPEN",
                           "CLOSE",
                           min,
                           max,
                           previous,
                           extern,
                           percent,
                           indicatief,
                           notation,
                           RAWTOHEX(STANDARD_HASH(notation || TO_CHAR(day,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.notation_price
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/notation_price/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:priceDay ;
                            rr:objectMap [ rr:column   "day" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [rr:predicate bhf:argentValue ;
                           rr:objectMap [rr:column "argent" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:papierValue ;
                           rr:objectMap [rr:column "papier" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:openValue ;
                           rr:objectMap [rr:column "open" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:closeValue ;
                           rr:objectMap [rr:column "close" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:minValue ;
                           rr:objectMap [rr:column "min" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:maxValue ;
                           rr:objectMap [rr:column "max" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:previousValue ;
                           rr:objectMap [rr:column "previous" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:externValue ;
                           rr:objectMap [rr:column "extern" ;
                                         rr:datatype xsd:integer]] ;
    rr:predicateObjectMap [rr:predicate bhf:inPercent ;
                           rr:objectMap [rr:column "percent" ;
                                         rr:datatype xsd:string]] ;
    rr:predicateObjectMap [rr:predicate bhf:indicativePrice ;
                           rr:objectMap [rr:column "indicatief" ;
                                         rr:datatype xsd:integer]] .

###################
# SECTOR
##################
:SECTOR-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT id FROM scoball.sector
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/sector/{id}" ;
                      rr:class    bhf:Sector ] .

:SECTOR-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT id,
                           CASE
                               WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                           END AS startdate_fixed,
                           CASE
                               WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                           END AS enddate_fixed
                    FROM scoball.sector
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/sector/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] .

:SECTOR-NAME
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT sector,
                           RAWTOHEX(STANDARD_HASH(sector || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.sector_name
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/sector/{sector}" ] ;
    rr:predicateObjectMap [ rr:predicate bhf:hasName ;
                            rr:objectMap [ rr:template "http://belhisfirm.be/resource/sector_name/{id}" ] ] .

:SECTOR-NAME-TYPE
    a               rr:TriplesMap ;
    rr:logicalTable [ rr:sqlQuery """
                    SELECT RAWTOHEX(STANDARD_HASH(sector || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id
                    FROM scoball.sector_name
    """ ] ;
    rr:subjectMap   [ rr:template "http://belhisfirm.be/resource/sector_name/{id}" ;
                      rr:class    bhf:DatedName ] .

:SECTOR-NAME-PROPERTIES
    a                     rr:TriplesMap ;
    rr:logicalTable       [ rr:sqlQuery """
                    SELECT RAWTOHEX(STANDARD_HASH(sector || TO_CHAR(startdate,'YYYY-MM-DD'), 'SHA1')) as id,
                           CASE
                               WHEN startdate <= TO_DATE('1000-12-31','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(startdate, 'YYYY-MM-DD')
                           END AS startdate_fixed,
                           CASE
                               WHEN enddate >= TO_DATE('3900-01-01','YYYY-MM-DD') THEN NULL
                               ELSE TO_CHAR(enddate, 'YYYY-MM-DD')
                           END AS enddate_fixed,
                           name
                    FROM scoball.sector_name
    """ ] ;
    rr:subjectMap         [ rr:template "http://belhisfirm.be/resource/sector_name/{id}" ] ;
    rr:predicateObjectMap [ rr:predicate rdfs:label ;
                            rr:objectMap [ rr:column   "name" ;
                                           rr:datatype xsd:string ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:startDate ;
                            rr:objectMap [ rr:column   "startdate_fixed" ;
                                           rr:datatype xsd:date ] ] ;
    rr:predicateObjectMap [ rr:predicate bhf:endDate ;
                            rr:objectMap [ rr:column   "enddate_fixed" ;
                                           rr:datatype xsd:date ] ] .

